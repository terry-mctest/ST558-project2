<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM+8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB/aFGpk3jaTY6xa8JAGMW/O62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v+k/0an2i+itHDw3v2+9+DBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3/I7AtxEJLtzzuZfI+VVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy/Lt7Kc+0vWY/gAgIIEqAN9we0pwKXreiMasxvabDQMM4riO+qxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw+ymhce7vwM9jSqO8JyVd5RH9gyTt2+J/yUmYlIR0s04n6+7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv/ocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi+W2+MjCzMIDApSwvXzC97Z4Ig8N/BxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh/8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT+AEjAwuDFpBmA9KMDEwMCh9i/v8H8sH0/4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9/lqYwOGZxeUelN2U2R6+cArgtCJpauW7UQBqnFkUsjAY/kOU1cP+DAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl+vvmM/byA48e6tWrKArm4ZJlCbdsrxksL1AwWn/yBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO//sdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd/89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF+9JOS0nbaaYDCQfwCJ7Au3AHj+LO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm+EBXuAbHmIMSRMs+4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL+hD7C1xoaHeLJSEao0FEW14ckxC+TU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13/+lm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl+9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O/AdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB///AA8AAQAAAAAAAAAAAAAAAAABAAAAAA==) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
box-sizing: border-box;
min-width: 200px;
max-width: 980px;
margin: 0 auto;
padding: 45px;
padding-top: 0px;
}
</style>


</head>

<body>

<h1 id="st558-fall-2023-project-2">ST558 Fall 2023, Project 2</h1>
<p>Terry McTest 2023-10-11</p>
<br>

<p>This vignette focuses on a custom function that was developed for use
in conjunction with a particular API (Application Programming Interface)
in order to query, parse, and return well-structured data. After using
said function to obtain data, an exploratory data analysis will be
performed. <br></p>
<h1 id="the-official-carbon-intensity-api-for-great-britain">The
Official Carbon Intensity API for Great Britain</h1>
<p>The Carbon Intensity API provides information regarding regional
carbon intensity of the electricity system in Great Britain. Since
carbon intensity varies by hour, day, and season (due changes in demand
as well as changes in means of generating electricity), these data are
stored at the micro-level, e.g. individual carbon intensity readings for
each half-hour period over a number of years. Per the [National Grid’s
Carbon Intensity API website] (<a href="https://carbon-intensity.github.io/api-definitions/?shell#carbon-intensity-api-v2-0-0">https://carbon-intensity.github.io/api-definitions/?shell#carbon-intensity-api-v2-0-0</a>):</p>
<blockquote>
<p>National Grid’s Carbon Intensity API provides an indicative trend of
regional carbon intensity of the electricity system in Great Britain
(GB) up to 2 days ahead of real-time. It provides programmatic and
timely access to both forecast and estimated carbon intensity data. The
Carbon Intensity forecast includes CO2 emissions related to electricity
generation only. The includes emissions from all large metered power
stations, interconnector imports, transmission and distribution losses,
and accounts for national electricity demand, embedded wind and solar
generation.</p>
</blockquote>
<p>The API consists of three primary endpoints:</p>
<ul>
<li><em>National-level carbon intensity</em>. This endpoint includes a
continuous measure of forecasted CO2 emissions per kilowatt hour of
electricity produced; a continuous measure of actual CO2 emissions
produced; and a categorical measure of actual CO2 emissions
produced.</li>
<li><em>National-level electricity-generation mix</em>. This endpoint
includes the percent distribution of how electricity is generated across
various generation sources, including biomass, coal, imports, gas,
nuclear, hydro, solar, wind, and “other”.</li>
<li><em>Regional-level carbon intensity &amp; electricity-generation
mix</em>. This endpoint includes (most) measures made available in the
above endpoints, though measures in the regional-level endpoint are
stored at a regional level (i.e. for each of 18 regions of Great
Britain) as opposed to being stored at a national level. <br></li>
</ul>
<h1 id="function-for-returning-data-from-the-api">Function for Returning
Data From the API</h1>
<p>Before proceeding, we should make note of the specific R packages
that are employed by either the custom function presented here, and/or
by the exploratory data analysis to follow:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span></code></pre></div>
<br>

<p>A function intended to return data from the Carbon Intensity (CI) API
must be capable of navigating certain features of this API:</p>
<ul>
<li>The CI API needs to know the window of time for which data is
desired, even if that “window” is essentially a specific point in time
(e.g. “right now”) as opposed to an actual extended window.</li>
<li>The CI API is comprised of data objects nested within data objects
(e.g. data frames within data frames), and these structures must be
un-nested and re-structured to facilitate use of the data.</li>
<li>In general terms, the national data is structured as one record per
each half-hour period contained within the specified window of time,
while the regional data is structured with 18 records (one for each
region) per each half-hour period contained within the specified window
of time. The function must account for whether one or both types of data
are desired (i.e. national-level data and/or regional-level data).</li>
</ul>
<p>The function presented here addresses the above features of the CI
API by first requesting specification of the following arguments:</p>
<ul>
<li>“from_dt” and “to_dt”: These are required arguments, each
representing a timestamp which bookends the window of time for which
data is desired.</li>
<li>“want_int”, “want_gen”, “want_reg_wide”, and “want_reg_long”: These
are optional arguments through which the end user specifies (by setting
the applicable argument equal to 1) whether they are requesting
national-level intensity data; national-level generation-mix data;
regional-level data (in wide format); and/or regional-level data (in
long format).</li>
</ul>
<p>The output of the CI API function call (named simply “carbon” as
shown here) is a list comprised of either: one wide dataset + one long
dataset; a wide dataset only; or a long dataset only. More specifically,
by selectively setting the aforementioned optional arguments to 1, the
user will receive a wide dataset comprised of either:</p>
<ol style="list-style-type: decimal">
<li>national-level intensity data + national-level generation-mix data +
regional-level data;</li>
<li>national-level intensity data + national-level generation-mix
data;</li>
<li>national-level intensity data + regional-level data;</li>
<li>national-level generation-mix data + regional-level data;</li>
<li>national-level intensity data only;</li>
<li>national-level generation-mix data only; or</li>
<li>regional-level data only</li>
</ol>
<p>Each version of the wide dataset listed above can be output with or
without an accompanying long dataset of regional-level data, for a total
of (7 x 2) + 1 = 15 data request options/combinations (the “+1” option
would be the long dataset of regional-level data with no wide dataset).
Notably, each of these 15 options/combinations could be used in
conjunction with an infinite number of time windows, providing the user
with an even greater number of options for each data request.</p>
<p>The “carbon” function also converts the bookend timestamps (which are
simply textstrings in “YYYY-MM-DDTHH:MMZ” format as required to access
the CI API) to simple quasi-date numeric values (e.g. YYYYMM) to
facilitate the exploratory data analysis (though a proper date value may
be required for more rigorous analyses).</p>
<p>The code chunk to follow shows R syntax for the entire “carbon”
function, annotated with comments to describe the purpose of each
sub-chunk of code:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>carbon <span class="ot">&lt;-</span> <span class="cf">function</span>(from_dt, to_dt, <span class="at">want_int=</span><span class="dv">0</span>, <span class="at">want_gen=</span><span class="dv">0</span>, <span class="at">want_reg_wide=</span><span class="dv">0</span>, <span class="at">want_reg_long=</span><span class="dv">0</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>{</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  </span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#national-level carbon intensity data/endpoint</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="cf">if</span>(want_int<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>{</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>base <span class="ot">=</span> <span class="st">&quot;https://api.carbonintensity.org.uk/intensity/&quot;</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>slash <span class="ot">=</span> <span class="st">&quot;/&quot;</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>int_url <span class="ot">=</span> <span class="fu">paste0</span>(base, from_dt, slash, to_dt)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>int_api <span class="ot">&lt;-</span> <span class="fu">GET</span>(int_url)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>parsed_int <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="fu">rawToChar</span>(int_api<span class="sc">$</span>content))</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#str(parsed_int$data)</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#as_tibble(parsed_int$data)</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>int <span class="ot">&lt;-</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>  parsed_int<span class="sc">$</span>data <span class="sc">%&gt;%</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>  <span class="fu">unnest</span>(intensity)</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>}</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>  </span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#national-level electricity-generation mix data/endpoint</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="cf">if</span>(want_gen<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>{</span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>base <span class="ot">=</span> <span class="st">&quot;https://api.carbonintensity.org.uk/generation/&quot;</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>slash <span class="ot">=</span> <span class="st">&quot;/&quot;</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>gen_url <span class="ot">=</span> <span class="fu">paste0</span>(base, from_dt, slash, to_dt)</span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>  </span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>gen_api <span class="ot">&lt;-</span> <span class="fu">GET</span>(gen_url)</span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a>parsed_gen <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="fu">rawToChar</span>(gen_api<span class="sc">$</span>content))</span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a><span class="co">#str(parsed_gen$data)</span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a><span class="co">#as_tibble(parsed_gen$data)</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a>gen <span class="ot">&lt;-</span></span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a>  parsed_gen<span class="sc">$</span>data <span class="sc">%&gt;%</span></span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a>  <span class="fu">unnest</span>(generationmix) <span class="sc">%&gt;%</span></span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> perc)</span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a>}</span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a>  </span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a><span class="co">#regional-level data/endpoint</span></span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a>  </span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a><span class="cf">if</span>(want_reg_wide<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> want_reg_long<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a>{</span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a>base <span class="ot">=</span> <span class="st">&quot;https://api.carbonintensity.org.uk/regional/intensity/&quot;</span></span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a>slash <span class="ot">=</span> <span class="st">&quot;/&quot;</span></span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a>reg_url <span class="ot">=</span> <span class="fu">paste0</span>(base, from_dt, slash, to_dt)</span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a>  </span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a>regional_api <span class="ot">&lt;-</span> <span class="fu">GET</span>(reg_url)</span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a>parsed_regional <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="fu">rawToChar</span>(regional_api<span class="sc">$</span>content))</span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a><span class="co">#str(parsed_regional$data)</span></span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a><span class="co">#as_tibble(parsed_regional$data)</span></span>
<span id="cb2-60"><a href="#cb2-60" tabindex="-1"></a>  </span>
<span id="cb2-61"><a href="#cb2-61" tabindex="-1"></a>reg_long <span class="ot">&lt;-</span></span>
<span id="cb2-62"><a href="#cb2-62" tabindex="-1"></a>  parsed_regional<span class="sc">$</span>data <span class="sc">%&gt;%</span></span>
<span id="cb2-63"><a href="#cb2-63" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-64"><a href="#cb2-64" tabindex="-1"></a>  <span class="fu">unnest</span>(regions) <span class="sc">%&gt;%</span></span>
<span id="cb2-65"><a href="#cb2-65" tabindex="-1"></a>  <span class="fu">unnest</span>(intensity) <span class="sc">%&gt;%</span></span>
<span id="cb2-66"><a href="#cb2-66" tabindex="-1"></a>  <span class="fu">unnest</span>(generationmix) <span class="sc">%&gt;%</span></span>
<span id="cb2-67"><a href="#cb2-67" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel, <span class="at">values_from =</span> perc)</span>
<span id="cb2-68"><a href="#cb2-68" tabindex="-1"></a>}</span>
<span id="cb2-69"><a href="#cb2-69" tabindex="-1"></a>  </span>
<span id="cb2-70"><a href="#cb2-70" tabindex="-1"></a><span class="cf">if</span>(want_reg_wide<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-71"><a href="#cb2-71" tabindex="-1"></a>{</span>
<span id="cb2-72"><a href="#cb2-72" tabindex="-1"></a>reg_wide <span class="ot">&lt;-</span></span>
<span id="cb2-73"><a href="#cb2-73" tabindex="-1"></a> reg_long <span class="sc">%&gt;%</span></span>
<span id="cb2-74"><a href="#cb2-74" tabindex="-1"></a>  <span class="fu">select</span>(from, to, regionid, forecast, index, biomass, coal, imports, gas, nuclear, other, hydro, solar, wind) <span class="sc">%&gt;%</span></span>
<span id="cb2-75"><a href="#cb2-75" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> regionid, </span>
<span id="cb2-76"><a href="#cb2-76" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(forecast, index, biomass, coal, imports, gas, nuclear, other, hydro, solar, wind))</span>
<span id="cb2-77"><a href="#cb2-77" tabindex="-1"></a>}</span>
<span id="cb2-78"><a href="#cb2-78" tabindex="-1"></a>  </span>
<span id="cb2-79"><a href="#cb2-79" tabindex="-1"></a>  </span>
<span id="cb2-80"><a href="#cb2-80" tabindex="-1"></a></span>
<span id="cb2-81"><a href="#cb2-81" tabindex="-1"></a><span class="co">#compile the *wide* dataset for outputting</span></span>
<span id="cb2-82"><a href="#cb2-82" tabindex="-1"></a>  </span>
<span id="cb2-83"><a href="#cb2-83" tabindex="-1"></a><span class="cf">if</span>(want_int<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> want_gen<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> want_reg_wide<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-84"><a href="#cb2-84" tabindex="-1"></a>  {carbon_wide <span class="ot">&lt;-</span> <span class="fu">full_join</span>(int, gen, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;to&quot;</span><span class="ot">=</span><span class="st">&quot;to&quot;</span>, <span class="st">&quot;from&quot;</span><span class="ot">=</span><span class="st">&quot;from&quot;</span>))</span>
<span id="cb2-85"><a href="#cb2-85" tabindex="-1"></a>   carbon_wide <span class="ot">&lt;-</span> <span class="fu">full_join</span>(carbon_wide, reg_wide, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;to&quot;</span><span class="ot">=</span><span class="st">&quot;to&quot;</span>, <span class="st">&quot;from&quot;</span><span class="ot">=</span><span class="st">&quot;from&quot;</span>))}</span>
<span id="cb2-86"><a href="#cb2-86" tabindex="-1"></a>  </span>
<span id="cb2-87"><a href="#cb2-87" tabindex="-1"></a><span class="cf">else</span> <span class="cf">if</span>(want_int<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> want_gen<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-88"><a href="#cb2-88" tabindex="-1"></a>  {carbon_wide <span class="ot">&lt;-</span> <span class="fu">full_join</span>(int, gen, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;to&quot;</span><span class="ot">=</span><span class="st">&quot;to&quot;</span>, <span class="st">&quot;from&quot;</span><span class="ot">=</span><span class="st">&quot;from&quot;</span>))}</span>
<span id="cb2-89"><a href="#cb2-89" tabindex="-1"></a></span>
<span id="cb2-90"><a href="#cb2-90" tabindex="-1"></a><span class="cf">else</span> <span class="cf">if</span>(want_int<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> want_reg_wide<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-91"><a href="#cb2-91" tabindex="-1"></a>  {carbon_wide <span class="ot">&lt;-</span> <span class="fu">full_join</span>(int, reg_wide, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;to&quot;</span><span class="ot">=</span><span class="st">&quot;to&quot;</span>, <span class="st">&quot;from&quot;</span><span class="ot">=</span><span class="st">&quot;from&quot;</span>))}</span>
<span id="cb2-92"><a href="#cb2-92" tabindex="-1"></a>  </span>
<span id="cb2-93"><a href="#cb2-93" tabindex="-1"></a><span class="cf">else</span> <span class="cf">if</span>(want_gen<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> want_reg_wide<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-94"><a href="#cb2-94" tabindex="-1"></a>  {carbon_wide <span class="ot">&lt;-</span> <span class="fu">full_join</span>(gen, reg_wide, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;to&quot;</span><span class="ot">=</span><span class="st">&quot;to&quot;</span>, <span class="st">&quot;from&quot;</span><span class="ot">=</span><span class="st">&quot;from&quot;</span>))}</span>
<span id="cb2-95"><a href="#cb2-95" tabindex="-1"></a></span>
<span id="cb2-96"><a href="#cb2-96" tabindex="-1"></a><span class="cf">else</span> <span class="cf">if</span>(want_int<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-97"><a href="#cb2-97" tabindex="-1"></a>  {carbon_wide <span class="ot">&lt;-</span> int}</span>
<span id="cb2-98"><a href="#cb2-98" tabindex="-1"></a>  </span>
<span id="cb2-99"><a href="#cb2-99" tabindex="-1"></a><span class="cf">else</span> <span class="cf">if</span>(want_gen<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-100"><a href="#cb2-100" tabindex="-1"></a>  {carbon_wide <span class="ot">&lt;-</span> gen}</span>
<span id="cb2-101"><a href="#cb2-101" tabindex="-1"></a></span>
<span id="cb2-102"><a href="#cb2-102" tabindex="-1"></a><span class="cf">else</span> <span class="cf">if</span>(want_reg_wide<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-103"><a href="#cb2-103" tabindex="-1"></a>  {carbon_wide <span class="ot">&lt;-</span> reg_wide}</span>
<span id="cb2-104"><a href="#cb2-104" tabindex="-1"></a></span>
<span id="cb2-105"><a href="#cb2-105" tabindex="-1"></a></span>
<span id="cb2-106"><a href="#cb2-106" tabindex="-1"></a>  </span>
<span id="cb2-107"><a href="#cb2-107" tabindex="-1"></a></span>
<span id="cb2-108"><a href="#cb2-108" tabindex="-1"></a><span class="co">#to facilitate downstream analyses, derive a set of more-usable date/season vars</span></span>
<span id="cb2-109"><a href="#cb2-109" tabindex="-1"></a>  </span>
<span id="cb2-110"><a href="#cb2-110" tabindex="-1"></a>carbon_wide<span class="sc">$</span>yyyy <span class="ot">=</span> <span class="fu">substring</span>(carbon_wide<span class="sc">$</span>from, <span class="at">first=</span><span class="dv">1</span>, <span class="at">last=</span><span class="dv">4</span>)</span>
<span id="cb2-111"><a href="#cb2-111" tabindex="-1"></a>carbon_wide<span class="sc">$</span>mm <span class="ot">=</span> <span class="fu">substring</span>(carbon_wide<span class="sc">$</span>from, <span class="at">first=</span><span class="dv">6</span>, <span class="at">last=</span><span class="dv">7</span>)</span>
<span id="cb2-112"><a href="#cb2-112" tabindex="-1"></a>carbon_wide<span class="sc">$</span>yyyymm <span class="ot">=</span> <span class="fu">paste0</span>(carbon_wide<span class="sc">$</span>yyyy, carbon_wide<span class="sc">$</span>mm)</span>
<span id="cb2-113"><a href="#cb2-113" tabindex="-1"></a></span>
<span id="cb2-114"><a href="#cb2-114" tabindex="-1"></a>carbon_wide<span class="sc">$</span>season <span class="ot">=</span></span>
<span id="cb2-115"><a href="#cb2-115" tabindex="-1"></a>  <span class="fu">if_else</span>(carbon_wide<span class="sc">$</span>mm <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;04&quot;</span>, <span class="st">&quot;05&quot;</span>, <span class="st">&quot;06&quot;</span>), <span class="st">&quot;spring&quot;</span>,</span>
<span id="cb2-116"><a href="#cb2-116" tabindex="-1"></a>  <span class="fu">if_else</span>(carbon_wide<span class="sc">$</span>mm <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;07&quot;</span>, <span class="st">&quot;08&quot;</span>, <span class="st">&quot;09&quot;</span>), <span class="st">&quot;summer&quot;</span>,</span>
<span id="cb2-117"><a href="#cb2-117" tabindex="-1"></a>  <span class="fu">if_else</span>(carbon_wide<span class="sc">$</span>mm <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;10&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;12&quot;</span>), <span class="st">&quot;fall&quot;</span>,</span>
<span id="cb2-118"><a href="#cb2-118" tabindex="-1"></a>  <span class="fu">if_else</span>(carbon_wide<span class="sc">$</span>mm <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;01&quot;</span>, <span class="st">&quot;02&quot;</span>, <span class="st">&quot;03&quot;</span>), <span class="st">&quot;winter&quot;</span>, <span class="cn">NA</span>))))</span>
<span id="cb2-119"><a href="#cb2-119" tabindex="-1"></a></span>
<span id="cb2-120"><a href="#cb2-120" tabindex="-1"></a>reg_long<span class="sc">$</span>yyyy <span class="ot">=</span> <span class="fu">substring</span>(reg_long<span class="sc">$</span>from, <span class="at">first=</span><span class="dv">1</span>, <span class="at">last=</span><span class="dv">4</span>)</span>
<span id="cb2-121"><a href="#cb2-121" tabindex="-1"></a>reg_long<span class="sc">$</span>mm <span class="ot">=</span> <span class="fu">substring</span>(reg_long<span class="sc">$</span>from, <span class="at">first=</span><span class="dv">6</span>, <span class="at">last=</span><span class="dv">7</span>)</span>
<span id="cb2-122"><a href="#cb2-122" tabindex="-1"></a>reg_long<span class="sc">$</span>yyyymm <span class="ot">=</span> <span class="fu">paste0</span>(reg_long<span class="sc">$</span>yyyy, reg_long<span class="sc">$</span>mm)</span>
<span id="cb2-123"><a href="#cb2-123" tabindex="-1"></a></span>
<span id="cb2-124"><a href="#cb2-124" tabindex="-1"></a>reg_long<span class="sc">$</span>season <span class="ot">=</span></span>
<span id="cb2-125"><a href="#cb2-125" tabindex="-1"></a>  <span class="fu">if_else</span>(reg_long<span class="sc">$</span>mm <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;04&quot;</span>, <span class="st">&quot;05&quot;</span>, <span class="st">&quot;06&quot;</span>), <span class="st">&quot;spring&quot;</span>,</span>
<span id="cb2-126"><a href="#cb2-126" tabindex="-1"></a>  <span class="fu">if_else</span>(reg_long<span class="sc">$</span>mm <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;07&quot;</span>, <span class="st">&quot;08&quot;</span>, <span class="st">&quot;09&quot;</span>), <span class="st">&quot;summer&quot;</span>,</span>
<span id="cb2-127"><a href="#cb2-127" tabindex="-1"></a>  <span class="fu">if_else</span>(reg_long<span class="sc">$</span>mm <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;10&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;12&quot;</span>), <span class="st">&quot;fall&quot;</span>,</span>
<span id="cb2-128"><a href="#cb2-128" tabindex="-1"></a>  <span class="fu">if_else</span>(reg_long<span class="sc">$</span>mm <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;01&quot;</span>, <span class="st">&quot;02&quot;</span>, <span class="st">&quot;03&quot;</span>), <span class="st">&quot;winter&quot;</span>, <span class="cn">NA</span>))))</span>
<span id="cb2-129"><a href="#cb2-129" tabindex="-1"></a></span>
<span id="cb2-130"><a href="#cb2-130" tabindex="-1"></a></span>
<span id="cb2-131"><a href="#cb2-131" tabindex="-1"></a>  </span>
<span id="cb2-132"><a href="#cb2-132" tabindex="-1"></a>    </span>
<span id="cb2-133"><a href="#cb2-133" tabindex="-1"></a><span class="co">#final output, which is either:</span></span>
<span id="cb2-134"><a href="#cb2-134" tabindex="-1"></a><span class="co">#(1) a list comprised of one long dataset + one wide dataset, (2) a single wide dataset, or (3) a single long dataset</span></span>
<span id="cb2-135"><a href="#cb2-135" tabindex="-1"></a><span class="co"># (the long dataset will always be regional data)</span></span>
<span id="cb2-136"><a href="#cb2-136" tabindex="-1"></a>  </span>
<span id="cb2-137"><a href="#cb2-137" tabindex="-1"></a><span class="cf">if</span>(want_reg_long<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> (want_int<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> want_gen<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> want_reg_wide<span class="sc">==</span><span class="dv">1</span>))</span>
<span id="cb2-138"><a href="#cb2-138" tabindex="-1"></a>  {carbon_dat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">reg_long=</span>reg_long, <span class="at">carbon_wide=</span>carbon_wide)}</span>
<span id="cb2-139"><a href="#cb2-139" tabindex="-1"></a>  </span>
<span id="cb2-140"><a href="#cb2-140" tabindex="-1"></a><span class="cf">else</span> <span class="cf">if</span>(want_int<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> want_gen<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> want_reg_wide<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-141"><a href="#cb2-141" tabindex="-1"></a>  {carbon_dat <span class="ot">&lt;-</span> carbon_wide}</span>
<span id="cb2-142"><a href="#cb2-142" tabindex="-1"></a></span>
<span id="cb2-143"><a href="#cb2-143" tabindex="-1"></a><span class="cf">else</span> <span class="cf">if</span>(want_reg_long<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-144"><a href="#cb2-144" tabindex="-1"></a>  {carbon_dat <span class="ot">&lt;-</span> reg_long}</span>
<span id="cb2-145"><a href="#cb2-145" tabindex="-1"></a>  </span>
<span id="cb2-146"><a href="#cb2-146" tabindex="-1"></a>}</span></code></pre></div>
<br>

<h1 id="using-the-custom-function-to-return-data">Using the Custom
Function to Return Data</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>jan2019 <span class="ot">&lt;-</span> <span class="fu">carbon</span>(<span class="at">from_dt=</span><span class="st">&quot;2019-01-10T12:00Z&quot;</span>, <span class="at">to_dt=</span><span class="st">&quot;2019-01-20T12:00Z&quot;</span>, <span class="at">want_int=</span><span class="dv">1</span>, <span class="at">want_gen=</span><span class="dv">1</span>, <span class="at">want_reg_wide=</span><span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>feb2019 <span class="ot">&lt;-</span> <span class="fu">carbon</span>(<span class="at">from_dt=</span><span class="st">&quot;2019-02-10T12:00Z&quot;</span>, <span class="at">to_dt=</span><span class="st">&quot;2019-02-20T12:00Z&quot;</span>, <span class="at">want_int=</span><span class="dv">1</span>, <span class="at">want_gen=</span><span class="dv">1</span>, <span class="at">want_reg_wide=</span><span class="dv">1</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>mar2019 <span class="ot">&lt;-</span> <span class="fu">carbon</span>(<span class="at">from_dt=</span><span class="st">&quot;2019-03-10T12:00Z&quot;</span>, <span class="at">to_dt=</span><span class="st">&quot;2019-03-20T12:00Z&quot;</span>, <span class="at">want_int=</span><span class="dv">1</span>, <span class="at">want_gen=</span><span class="dv">1</span>, <span class="at">want_reg_wide=</span><span class="dv">1</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>apr2019 <span class="ot">&lt;-</span> <span class="fu">carbon</span>(<span class="at">from_dt=</span><span class="st">&quot;2019-04-10T12:00Z&quot;</span>, <span class="at">to_dt=</span><span class="st">&quot;2019-04-20T12:00Z&quot;</span>, <span class="at">want_int=</span><span class="dv">1</span>, <span class="at">want_gen=</span><span class="dv">1</span>, <span class="at">want_reg_wide=</span><span class="dv">1</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>may2019 <span class="ot">&lt;-</span> <span class="fu">carbon</span>(<span class="at">from_dt=</span><span class="st">&quot;2019-05-10T12:00Z&quot;</span>, <span class="at">to_dt=</span><span class="st">&quot;2019-05-20T12:00Z&quot;</span>, <span class="at">want_int=</span><span class="dv">1</span>, <span class="at">want_gen=</span><span class="dv">1</span>, <span class="at">want_reg_wide=</span><span class="dv">1</span>)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>jun2019 <span class="ot">&lt;-</span> <span class="fu">carbon</span>(<span class="at">from_dt=</span><span class="st">&quot;2019-06-10T12:00Z&quot;</span>, <span class="at">to_dt=</span><span class="st">&quot;2019-06-20T12:00Z&quot;</span>, <span class="at">want_int=</span><span class="dv">1</span>, <span class="at">want_gen=</span><span class="dv">1</span>, <span class="at">want_reg_wide=</span><span class="dv">1</span>)</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>jul2019 <span class="ot">&lt;-</span> <span class="fu">carbon</span>(<span class="at">from_dt=</span><span class="st">&quot;2019-07-10T12:00Z&quot;</span>, <span class="at">to_dt=</span><span class="st">&quot;2019-07-20T12:00Z&quot;</span>, <span class="at">want_int=</span><span class="dv">1</span>, <span class="at">want_gen=</span><span class="dv">1</span>, <span class="at">want_reg_wide=</span><span class="dv">1</span>)</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>aug2019 <span class="ot">&lt;-</span> <span class="fu">carbon</span>(<span class="at">from_dt=</span><span class="st">&quot;2019-08-10T12:00Z&quot;</span>, <span class="at">to_dt=</span><span class="st">&quot;2019-08-20T12:00Z&quot;</span>, <span class="at">want_int=</span><span class="dv">1</span>, <span class="at">want_gen=</span><span class="dv">1</span>, <span class="at">want_reg_wide=</span><span class="dv">1</span>)</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>sep2019 <span class="ot">&lt;-</span> <span class="fu">carbon</span>(<span class="at">from_dt=</span><span class="st">&quot;2019-09-10T12:00Z&quot;</span>, <span class="at">to_dt=</span><span class="st">&quot;2019-09-20T12:00Z&quot;</span>, <span class="at">want_int=</span><span class="dv">1</span>, <span class="at">want_gen=</span><span class="dv">1</span>, <span class="at">want_reg_wide=</span><span class="dv">1</span>)</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>oct2019 <span class="ot">&lt;-</span> <span class="fu">carbon</span>(<span class="at">from_dt=</span><span class="st">&quot;2019-10-10T12:00Z&quot;</span>, <span class="at">to_dt=</span><span class="st">&quot;2019-10-20T12:00Z&quot;</span>, <span class="at">want_int=</span><span class="dv">1</span>, <span class="at">want_gen=</span><span class="dv">1</span>, <span class="at">want_reg_wide=</span><span class="dv">1</span>)</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>nov2019 <span class="ot">&lt;-</span> <span class="fu">carbon</span>(<span class="at">from_dt=</span><span class="st">&quot;2019-11-10T12:00Z&quot;</span>, <span class="at">to_dt=</span><span class="st">&quot;2019-11-20T12:00Z&quot;</span>, <span class="at">want_int=</span><span class="dv">1</span>, <span class="at">want_gen=</span><span class="dv">1</span>, <span class="at">want_reg_wide=</span><span class="dv">1</span>)</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>dec2019 <span class="ot">&lt;-</span> <span class="fu">carbon</span>(<span class="at">from_dt=</span><span class="st">&quot;2019-12-10T12:00Z&quot;</span>, <span class="at">to_dt=</span><span class="st">&quot;2019-12-20T12:00Z&quot;</span>, <span class="at">want_int=</span><span class="dv">1</span>, <span class="at">want_gen=</span><span class="dv">1</span>, <span class="at">want_reg_wide=</span><span class="dv">1</span>)</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>year2019 <span class="ot">&lt;-</span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a>  <span class="fu">bind_rows</span>(jan2019, feb2019, mar2019, apr2019, may2019, jun2019, jul2019, aug2019, sep2019, oct2019, nov2019, dec2019)</span></code></pre></div>
<br>

<h1 id="exploratory-data-analysis">Exploratory Data Analysis</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_1)</span></code></pre></div>
<pre><code>## [1] 100.0561</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_2)</span></code></pre></div>
<pre><code>## [1] 33.27374</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_3)</span></code></pre></div>
<pre><code>## [1] 63.7694</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_4)</span></code></pre></div>
<pre><code>## [1] 45.05839</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_5)</span></code></pre></div>
<pre><code>## [1] 268.4652</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_6)</span></code></pre></div>
<pre><code>## [1] 236.8051</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_7)</span></code></pre></div>
<pre><code>## [1] 338.9783</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_8)</span></code></pre></div>
<pre><code>## [1] 180.9532</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_9)</span></code></pre></div>
<pre><code>## [1] 363.0371</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_10)</span></code></pre></div>
<pre><code>## [1] 149.5137</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_11)</span></code></pre></div>
<pre><code>## [1] 129.6942</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_12)</span></code></pre></div>
<pre><code>## [1] 258.442</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_13)</span></code></pre></div>
<pre><code>## [1] 216.3463</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_14)</span></code></pre></div>
<pre><code>## [1] 236.7277</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_15)</span></code></pre></div>
<pre><code>## [1] 202.9335</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_16)</span></code></pre></div>
<pre><code>## [1] 59.69196</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_17)</span></code></pre></div>
<pre><code>## [1] 279.7741</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">mean</span>(year2019<span class="sc">$</span>forecast_18)</span></code></pre></div>
<pre><code>## [1] 214.0347</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>year2019 <span class="ot">&lt;-</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>  year2019 <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>  <span class="fu">group_by</span>(index) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_actual =</span> <span class="fu">mean</span>(actual, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a><span class="co">#year2019$yyyy = substring(year2019$from, first=1, last=4)</span></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a><span class="co">#year2019$mm = substring(year2019$from, first=6, last=7)</span></span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a><span class="co">#year2019$yyyymm = paste0(year2019$yyyy, year2019$mm)</span></span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a>year2019 <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>  <span class="fu">group_by</span>(yyyymm) <span class="sc">%&gt;%</span></span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">mean</span>(actual, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 12 × 2
##    yyyymm `mean(actual, na.rm = TRUE)`
##    &lt;chr&gt;                         &lt;dbl&gt;
##  1 201901                         257.
##  2 201902                         196.
##  3 201903                         182.
##  4 201904                         213.
##  5 201905                         223.
##  6 201906                         219.
##  7 201907                         231.
##  8 201908                         178.
##  9 201909                         196.
## 10 201910                         207.
## 11 201911                         264.
## 12 201912                         218.</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">table</span>(year2019<span class="sc">$</span>index)</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="fu">prop.table</span>(tb)</span></code></pre></div>
<pre><code>## 
##        high         low    moderate   very high 
## 0.205994456 0.207726958 0.578135828 0.008142758</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co">#scatterplot: forecast x actual (by year?)</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a><span class="co">#line chart: *actual* over time (for national)</span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a><span class="co">#line chart: *psuedo-actual* over time (for regions)</span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a><span class="co">#stacked bar: generation mix (by time, and/or by region?)</span></span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a><span class="co">#ggradar? generation mix (by time, and/or by region?)</span></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a><span class="co">#cowplot?  actual by season? (for national)</span></span></code></pre></div>

</body>
</html>
